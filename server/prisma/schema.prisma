generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Student {
  id                String             @id @default(uuid())
  student_number    String             @unique
  first_name        String
  middle_name       String?
  last_name         String
  age               Int
  birth_date        String
  gender            GENDER
  religion          String
  contact_number    String
  address           Address?
  refreshToken      String?            @db.Text()
  email             String             @unique
  password          String
  profile_image     Profile_Image?
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @default(now())
  //! Only admin and professor can update this !!!
  school_year       String?
  school_college    String?
  school_course     String?
  school_section    String?
  role              ROLE               @default(STUDENT)
  type              TYPE               @default(REGULAR)
  subjects_enrolled SubjectsEnrolled[]
}

model Address {
  id          String  @id @default(uuid())
  Street_name String
  baranggay   String
  city        String
  region      String
  province    String
  postal_code String
  student_id  String  @unique
  Student     Student @relation(fields: [student_id], references: [id], onDelete: Cascade)
}

model Profile_Image {
  id         String   @id @default(uuid())
  secure_url String
  image_url  String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now())
  student_id String   @unique
  student    Student  @relation(fields: [student_id], references: [id], onDelete: Cascade)
}

model SubjectsEnrolled {
  id           String   @id @default(uuid())
  grade        Float?
  code         String
  subject_name String
  units        Int
  professor    String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now())
  Student   Student? @relation(fields: [studentId], references: [id],onDelete: Cascade)
  studentId String?
}

model admin {
  id           String   @id @default(uuid())
  name         String
  password     String
  refreshToken String?  @db.Text()
  role         String   @default("ADMIN")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now())
}

enum GENDER {
  MALE
  FEMALE
  GAY
  LESBIAN
  UNKNOWN
}

enum TYPE {
  REGULAR
  IRREGULAR
}

enum ROLE {
  STUDENT
  ADMIN
  PROFESSOR
}
